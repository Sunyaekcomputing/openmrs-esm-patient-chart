{"version":3,"file":"src_page-header_page-header_component_tsx.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAyE;AACiB;AA8B3E,SAASS,eAAe,KAA8C;QAA9C,uBAAEC;QAItBC,2BAAAA;IAHjB,IAAwBR,6BAAAA,+CAAQA,CAAc,WAAvCS,OAAiBT,cAAXU,UAAWV;IACxB,IAAwCA,8BAAAA,+CAAQA,CAAgB,EAAE,OAA3DW,eAAiCX,eAAnBY,kBAAmBZ;IACxC,IAAoCA,8BAAAA,+CAAQA,CAAC,SAAtCa,aAA6Bb,eAAjBc,gBAAiBd;QACnBQ;IAAjB,IAAMO,UAAU,CAACP,CAAAA,8BAAAA,4BAAAA,CAAAA,UAAAA,QAAOQ,iBAAiB,cAAxBR,gDAAAA,+BAAAA,sBAAAA,wCAAAA,6BAAgC,cAAa,EAAGS,OAAO,CAAC,OAAO;IAEhFnB,gDAASA,CAAC;QACRK,oEAAYA,CAAiB,GAAe,OAAZC,+DAAWA,EAAC,aACzCc,IAAI,CAAC,SAACC;mBAAQT,QAAQS,IAAIC,IAAI,CAACX,IAAI;WACnCY,KAAK,CAAC,SAACC;mBAAQC,QAAQC,KAAK,CAAC,4CAA4CF;;IAC9E,GAAG,EAAE;IAEL,IAAMG,YAAY1B,8CAAOA,CAAC;YACjBU;QAAP,OAAOA,CAAAA,iBAAAA,4BAAAA,cAAAA,KAAMiB,KAAK,cAAXjB,kCAAAA,YAAakB,GAAG,CAAC,SAACC;mBAAMA,EAAEC,OAAO,CAACC,WAAW;eAAO,EAAE;IAC/D,GAAG;QAACrB;KAAK;IAETX,gDAASA,CAAC;QACR,IAAMiC,sBAAsB;;oBAWtBZ,iBATIa,cAEAC,OAEAd,KAIAe,UAoBCZ;;;;;;;;;;4BA5BDU,eAAe,IAAIG;4BACzBH,aAAaI,OAAO,CAACJ,aAAaK,OAAO,KAAK;4BACxCJ,QAAQD,aAAaM,WAAW;4BAE1B;;gCAAMnC,oEAAYA,CAC5B,GAAyC8B,OAAtC5B,+DAAWA,EAAC,4BAAgC,OAAN4B,OAAM;;;4BAD3Cd,MAAM;4BAINe,WACJf,EAAAA,kBAAAA,IAAIC,IAAI,CAACmB,KAAK,cAAdpB,sCAAAA,gBAAgBQ,GAAG,CAAC,SAACa;oCAKfC,0BAAAA,qBAGcA;gCAPlB,IAAMA,UAAUD,EAAEE,QAAQ;gCAC1B,OAAO,wCACFD;oCACHE,OACEF,EAAAA,sBAAAA,QAAQG,UAAU,cAAlBH,2CAAAA,2BAAAA,oBAAoBI,IAAI,CAAC,SAACC;4CACxBA,eAAAA;gDAAAA,WAAAA,GAAGC,IAAI,cAAPD,gCAAAA,gBAAAA,SAASE,IAAI,cAAbF,oCAAAA,cAAehB,WAAW,GAAGmB,QAAQ,CAAC;oDADxCR,+CAAAA,yBAEGS,KAAK,KAAI;oCACdC,gBAAgBV,EAAAA,gBAAAA,QAAQW,IAAI,cAAZX,oCAAAA,cAAcY,WAAW,KAAI;;4BAEjD;4BAEFzC;gCACE;oCACEkC,IAAI;oCACJQ,MAAM;oCACNC,SAASrB;gCACX;;;;;;;4BAEKZ;4BACPC,QAAQC,KAAK,CAAC,oDAAoDF;;;;;;;;;;;YAEtE;;QAEA,IAAIG,UAAU+B,MAAM,IAAI,CAAC/B,UAAUwB,QAAQ,CAAC,sBAAsB;YAChElB;QACF;IACF,GAAG;QAACN;KAAU;IAEd,IAAMgC,aAAaxD,kDAAWA,CAAC;QAC7BC,gEAAQA,CAAC;YAAEwD,IAAI,GAAW,OAAR3C,SAAQ;QAAuB;IACnD,GAAG;QAACA;KAAQ;IAEd,IAAM4C,YAAY1D,kDAAWA,CACzB,SAACwC;QACC,IAAIA,QAAQK,EAAE,EAAE5C,gEAAQA,CAAC;YAAEwD,IAAI,GAAsBjB,OAAnB1B,SAAQ,aAAsB,OAAX0B,QAAQK,EAAE,EAAC;QAAQ;IAC1E,GACA;QAAC/B;KAAQ;IAIX,2CAA2C;IAC3C,IAAM6C,oBAAoB7D,8CAAOA,CAAC;YACZY;QAApB,IAAMkD,cAAclD,EAAAA,iBAAAA,YAAY,CAAC,EAAE,cAAfA,qCAAAA,eAAiB4C,OAAO,KAAI,EAAE;QAClD,IAAI,CAAC1C,WAAWiD,IAAI,IAAI,OAAOD;QAE/B,OAAOA,YAAYE,MAAM,CAAC,SAACC;gBACzBA;oBAAAA,WAAAA,EAAErB,KAAK,cAAPqB,+BAAAA,SAASlC,WAAW,GAAGmB,QAAQ,CAACpC,WAAWiB,WAAW;;IAE1D,GAAG;QAACjB;QAAYF;KAAa;IAE7B,qBACE,0HACGc,UAAUwB,QAAQ,CAAC,qCAClB,2DAACgB;QAAIC,OAAO;YAAErC,SAAS;YAAQsC,gBAAgB;YAAUC,WAAW;QAAQ;qBAC1E,2DAACC;QACCH,OAAO;YACLI,YAAY;YACZC,OAAO;YACPC,QAAQ;YACRC,cAAc;YACdC,SAAS;YACTC,UAAU;YACVC,YAAY;YACZC,YAAY;YACZC,QAAQ;YACRC,WAAW;YACXC,YAAY;QACd;QACAC,cAAc,SAACzC;mBAAOA,EAAE0C,aAAa,CAAChB,KAAK,CAACiB,SAAS,GAAG;;QACxDC,cAAc,SAAC5C;mBAAOA,EAAE0C,aAAa,CAAChB,KAAK,CAACiB,SAAS,GAAG;;QACxDE,SAAS5B;OACV,kDAKH,2DAACQ;QAAIC,OAAO;YAAEE,WAAW;YAAQkB,YAAY;YAAQT,YAAY;QAAmC;qBAClG,2DAACU;QAAGrB,OAAO;YAAEK,OAAO;YAAWI,UAAU;YAAUa,cAAc;QAAO;OAAG,yDAI3E,2DAACC;QACCvB,OAAO;YACLwB,OAAO;YACPC,gBAAgB;YAChBhB,UAAU;YACVI,WAAW;YACXN,cAAc;YACdmB,UAAU;QACZ;qBAEA,2DAACC,6BACC,2DAACC;QAAG5B,OAAO;YAAE6B,iBAAiB;YAAWxB,OAAO;QAAO;qBACrD,2DAACyB;QAAG9B,OAAO;YAAEQ,SAAS;YAAauB,WAAW;YAAQP,OAAO;QAAM;qBACjE,2DAACzB;QAAIC,OAAO;YAAErC,SAAS;YAAQqE,YAAY;YAAUC,KAAK;QAAO;OAAG,qCAElE,2DAACC;QACCrD,MAAK;QACLsD,aAAY;QACZnD,OAAOrC;QACPyF,UAAU,SAAC9D;mBAAM1B,cAAc0B,EAAE+D,MAAM,CAACrD,KAAK;;QAC7CgB,OAAO;YACLQ,SAAS;YACTC,UAAU;YACVF,cAAc;YACdD,QAAQ;YACRkB,OAAO;QACT;wBAIN,2DAACM;QAAG9B,OAAO;YAAEQ,SAAS;YAAauB,WAAW;QAAO;OAAG,+BAI5D,2DAACO,eACE5C,kBAAkBJ,MAAM,KAAK,kBAC5B,2DAACsC,0BACC,2DAACW;QAAGC,SAAS;QAAGxC,OAAO;YAAEQ,SAAS;YAAaiC,WAAW;QAAS;OAAG,yBAKxE/C,kBAAkBjC,GAAG,CAAC,SAACqC,GAAG4C;6BACxB,2DAACd;YACCe,KAAK7C,EAAElB,EAAE;YACTuC,SAAS;uBAAM1B,UAAUK;;YACzBE,OAAO;gBACLY,QAAQ;gBACRiB,iBAAiBa,MAAM,MAAM,IAAI,YAAY;gBAC7C5B,YAAY;YACd;YACAC,cAAc,SAACzC;uBAAOA,EAAE0C,aAAa,CAAChB,KAAK,CAAC6B,eAAe,GAAG;;YAC9DX,cAAc,SAAC5C;uBACZA,EAAE0C,aAAa,CAAChB,KAAK,CAAC6B,eAAe,GAAGa,MAAM,MAAM,IAAI,YAAY;;yBAGvE,2DAACH;YAAGvC,OAAO;gBAAEQ,SAAS;YAAY;WAAIV,EAAErB,KAAK,iBAC7C,2DAAC8D;YAAGvC,OAAO;gBAAEQ,SAAS;YAAY;WAC/BV,EAAEb,cAAc,GAAG,IAAIhB,KAAK6B,EAAEb,cAAc,EAAE2D,cAAc,KAAK;;AAWxF","sources":["webpack://@openmrs/esm-home-app/./src/page-header/page-header.component.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState, useCallback } from \"react\";\r\nimport { navigate, openmrsFetch, restBaseUrl, fhirBaseUrl } from \"@openmrs/esm-framework\";\r\nimport { launchWorkspace  } from \"@openmrs/esm-framework\";\r\nimport { formEntryWorkspace } from \"@openmrs/esm-patient-common-lib\";\r\n\r\n\r\n\r\ntype User = {\r\n  uuid: string;\r\n  username: string;\r\n  roles: { display: string }[];\r\n};\r\n\r\nexport interface SearchedPatient {\r\n  id: string;\r\n  name?: { text?: string; given?: string[]; family?: string }[];\r\n  identifier?: { system?: string; value?: string; type?: { text?: string } }[];\r\n  gender?: string;\r\n  birthDate?: string;\r\n  meta?: { lastUpdated?: string };\r\n  displayName?: string;\r\n  artId?: string;\r\n  registeredDate?: string;\r\n}\r\n\r\nexport interface PatientList {\r\n  id: string;\r\n  name: string;\r\n  members: SearchedPatient[];\r\n}\r\n\r\nexport default function HomePageHeader({ dashboardTitle }: { dashboardTitle: string }) {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [patientLists, setPatientLists] = useState<PatientList[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const baseUrl = (window.getOpenmrsSpaBase?.() ?? \"/openmrs/spa\").replace(/\\/$/, \"\");\r\n\r\n  useEffect(() => {\r\n    openmrsFetch<{ user: User }>(`${restBaseUrl}/session`)\r\n      .then((res) => setUser(res.data.user))\r\n      .catch((err) => console.error(\"[HomePageHeader] Error fetching session:\", err));\r\n  }, []);\r\n\r\n  const userRoles = useMemo(() => {\r\n    return user?.roles?.map((r) => r.display.toLowerCase()) || [];\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    const fetchRecentPatients = async () => {\r\n      try {\r\n        const sevenDaysAgo = new Date();\r\n        sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);\r\n        const since = sevenDaysAgo.toISOString();\r\n\r\n        const res = await openmrsFetch<{ entry?: { resource: SearchedPatient }[] }>(\r\n          `${fhirBaseUrl}/Patient?_lastUpdated=ge${since}&_sort=-_lastUpdated&_count=50`\r\n        );\r\n\r\n        const patients =\r\n          res.data.entry?.map((e) => {\r\n            const patient = e.resource;\r\n            return {\r\n              ...patient,\r\n              artId:\r\n                patient.identifier?.find((id) =>\r\n                  id.type?.text?.toLowerCase().includes(\"‡§Ü‡§´‡•ç‡§®‡•ã ‡§è‡§Ü‡§∞‡§ü‡§ø  ‡§Ü‡§à‡§°‡•Ä ‡§≤‡•á‡§ñ‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç\")\r\n                )?.value || \"N/A\",\r\n              registeredDate: patient.meta?.lastUpdated || \"N/A\",\r\n            };\r\n          }) || [];\r\n\r\n        setPatientLists([\r\n          {\r\n            id: \"recent-patients\",\r\n            name: \"‡§π‡§æ‡§≤‡•à ‡§¶‡§∞‡•ç‡§§‡§æ ‡§≠‡§è‡§ï‡§æ ‡§∏‡§π‡§≠‡§æ‡§ó‡•Ä‡§π‡§∞‡•Ç\",\r\n            members: patients,\r\n          },\r\n        ]);\r\n      } catch (err) {\r\n        console.error(\"[HomePageHeader] Error fetching recent patients:\", err);\r\n      }\r\n    };\r\n\r\n    if (userRoles.length && !userRoles.includes(\"self registration\")) {\r\n      fetchRecentPatients();\r\n    }\r\n  }, [userRoles]);\r\n\r\n  const addPatient = useCallback(() => {\r\n    navigate({ to: `${baseUrl}/patient-registration` });\r\n  }, [baseUrl]);\r\n\r\nconst openChart = useCallback(\r\n    (patient: SearchedPatient) => {\r\n      if (patient.id) navigate({ to: `${baseUrl}/patient/${patient.id}/chart` });\r\n    },\r\n    [baseUrl]\r\n  );\r\n\r\n\r\n  // üîç Filter patients locally as user types\r\n  const displayedPatients = useMemo(() => {\r\n    const allPatients = patientLists[0]?.members || [];\r\n    if (!searchTerm.trim()) return allPatients;\r\n\r\n    return allPatients.filter((p) =>\r\n      p.artId?.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n  }, [searchTerm, patientLists]);\r\n\r\n  return (\r\n    <>\r\n      {userRoles.includes(\"self registration\") ? (\r\n        <div style={{ display: \"flex\", justifyContent: \"center\", marginTop: \"100px\" }}>\r\n          <button\r\n            style={{\r\n              background: \"linear-gradient(145deg, #005d5d, #007f7f)\",\r\n              color: \"#fff\",\r\n              border: \"none\",\r\n              borderRadius: \"80px\",\r\n              padding: \"2rem 3.5rem\",\r\n              fontSize: \"2rem\",\r\n              fontWeight: 900,\r\n              fontFamily: \"Noto Sans Devanagari, sans-serif\",\r\n              cursor: \"pointer\",\r\n              boxShadow: \"0px 6px 12px rgba(0,0,0,0.25)\",\r\n              transition: \"all 0.3s ease\",\r\n            }}\r\n            onMouseEnter={(e) => (e.currentTarget.style.transform = \"scale(1.05)\")}\r\n            onMouseLeave={(e) => (e.currentTarget.style.transform = \"scale(1)\")}\r\n            onClick={addPatient}\r\n          >\r\n            ‚úçüèª ‡§¶‡§∞‡•ç‡§§‡§æ ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç\r\n          </button>\r\n        </div>\r\n      ) : (\r\n        <div style={{ marginTop: \"80px\", marginLeft: \"40px\", fontFamily: \"Noto Sans Devanagari, sans-serif\" }}>\r\n          <h3 style={{ color: \"#339E71\", fontSize: \"2.4rem\", marginBottom: \"25px\" }}>\r\n            üßæ ‡§π‡§æ‡§≤‡•à ‡§¶‡§∞‡•ç‡§§‡§æ ‡§≠‡§è‡§ï‡§æ ‡§∏‡§π‡§≠‡§æ‡§ó‡•Ä‡§π‡§∞‡•Ç\r\n          </h3>\r\n\r\n          <table\r\n            style={{\r\n              width: \"70%\",\r\n              borderCollapse: \"collapse\",\r\n              fontSize: \"1.1rem\",\r\n              boxShadow: \"0 4px 10px rgba(0,0,0,0.15)\",\r\n              borderRadius: \"12px\",\r\n              overflow: \"hidden\",\r\n            }}\r\n          >\r\n            <thead>\r\n              <tr style={{ backgroundColor: \"#005d5d\", color: \"#fff\" }}>\r\n                <th style={{ padding: \"14px 18px\", textAlign: \"left\", width: \"55%\" }}>\r\n                  <div style={{ display: \"flex\", alignItems: \"center\", gap: \"10px\" }}>\r\n                    ‡§∏‡§π‡§≠‡§æ‡§ó‡•Ä‡§ï‡•ã ‡§è‡§Ü‡§∞‡§ü‡§ø ‡§Ü‡§à‡§°‡•Ä\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"‡§ñ‡•ã‡§ú‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç...\"\r\n                      value={searchTerm}\r\n                      onChange={(e) => setSearchTerm(e.target.value)}\r\n                      style={{\r\n                        padding: \"6px 10px\",\r\n                        fontSize: \"0.9rem\",\r\n                        borderRadius: \"6px\",\r\n                        border: \"1px solid #ccc\",\r\n                        width: \"180px\",\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </th>\r\n                <th style={{ padding: \"14px 18px\", textAlign: \"left\" }}>‡§¶‡§∞‡•ç‡§§‡§æ ‡§Æ‡§ø‡§§‡§ø</th>\r\n              </tr>\r\n            </thead>\r\n\r\n            <tbody>\r\n              {displayedPatients.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan={2} style={{ padding: \"12px 18px\", fontStyle: \"italic\" }}>\r\n                    ‡§ï‡•Å‡§®‡•à ‡§∏‡§π‡§≠‡§æ‡§ó‡•Ä ‡§≠‡•á‡§ü‡§ø‡§è‡§®\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                displayedPatients.map((p, idx) => (\r\n                  <tr\r\n                    key={p.id}\r\n                    onClick={() => openChart(p)}\r\n                    style={{\r\n                      cursor: \"pointer\",\r\n                      backgroundColor: idx % 2 === 0 ? \"#f9fdf9\" : \"#ffffff\",\r\n                      transition: \"all 0.2s ease\",\r\n                    }}\r\n                    onMouseEnter={(e) => (e.currentTarget.style.backgroundColor = \"#e6f7f0\")}\r\n                    onMouseLeave={(e) =>\r\n                      (e.currentTarget.style.backgroundColor = idx % 2 === 0 ? \"#f9fdf9\" : \"#ffffff\")\r\n                    }\r\n                  >\r\n                    <td style={{ padding: \"12px 18px\" }}>{p.artId}</td>\r\n                    <td style={{ padding: \"12px 18px\" }}>\r\n                      {p.registeredDate ? new Date(p.registeredDate).toLocaleString() : \"N/A\"}\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n"],"names":["React","useEffect","useMemo","useState","useCallback","navigate","openmrsFetch","restBaseUrl","fhirBaseUrl","HomePageHeader","dashboardTitle","window","user","setUser","patientLists","setPatientLists","searchTerm","setSearchTerm","baseUrl","getOpenmrsSpaBase","replace","then","res","data","catch","err","console","error","userRoles","roles","map","r","display","toLowerCase","fetchRecentPatients","sevenDaysAgo","since","patients","Date","setDate","getDate","toISOString","entry","e","patient","resource","artId","identifier","find","id","type","text","includes","value","registeredDate","meta","lastUpdated","name","members","length","addPatient","to","openChart","displayedPatients","allPatients","trim","filter","p","div","style","justifyContent","marginTop","button","background","color","border","borderRadius","padding","fontSize","fontWeight","fontFamily","cursor","boxShadow","transition","onMouseEnter","currentTarget","transform","onMouseLeave","onClick","marginLeft","h3","marginBottom","table","width","borderCollapse","overflow","thead","tr","backgroundColor","th","textAlign","alignItems","gap","input","placeholder","onChange","target","tbody","td","colSpan","fontStyle","idx","key","toLocaleString"],"sourceRoot":""}